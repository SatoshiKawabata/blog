---
templateKey: blog-post
title: RaspberryPi + Node.js + opencv4nodejs で OpenCV を動かす
date: 2020-06-20T00:24:15.556Z
description: node.jsでOpenCVを動かすライブラリとしてよさそうなのは以下の2つあります。
---
node.jsでOpenCVを動かすライブラリとしてよさそうなのは以下の2つあります。

- [GitHub - peterbraden/node-opencv: OpenCV Bindings for node.js](https://github.com/peterbraden/node-opencv)
- [GitHub - justadudewhohacks/opencv4nodejs: Nodejs bindings to OpenCV 3 and OpenCV 4](https://github.com/justadudewhohacks/opencv4nodejs)

前者のnode-opencvに関しては下記の記事で動かしてみました。

[RaspberryPiでnode.js上でOpenCVを使う | blog.kwst.site](https://blog.kwst.site/202006144454/)

今回は[opencv4nodejs](https://github.com/justadudewhohacks/opencv4nodejs#readme)の方を動かしてみたいと思います。

## opencv4nodejsをRaspberryPiにインストール

RaspberryPiでnode.jsを動かす方法は下記記事を参照してください。

[RaspberryPiにnvmを入れてnode.jsのバージョン管理を行う | blog.kwst.site](https://blog.kwst.site/202006131357/)

opencv4nodejsの[READMEのInstalling OpenCV via Auto Build Script](https://github.com/justadudewhohacks/opencv4nodejs#installing-opencv-via-auto-build-script)によるとOpenCVは[npm-opencv-build](https://github.com/justadudewhohacks/npm-opencv-build)経由でインストールするみたいで、CMakeが必要みたいです。


## CMakeを入れる

[GitHub - justadudewhohacks/npm-opencv-build: A simple script to auto build recent OpenCV + contrib version via npm](https://github.com/justadudewhohacks/npm-opencv-build#requirements)

```
sudo apt-get update
sudo apt-get -y --force-yes install cmake
```

## opencv4nodejsをインストール

```
npm i opencv4nodejs
```

エラーが出ました。

```
> opencv-build@0.1.9 install /home/pi/opencv-virtualuvc/node_modules/opencv-build
> node ./install.js

info install OPENCV4NODEJS_DISABLE_AUTOBUILD is set
info install skipping auto build...

> opencv4nodejs@5.6.0 install /home/pi/opencv-virtualuvc/node_modules/opencv4nodejs
> node ./install/install.js

info install OPENCV_LIB_DIR is not set, looking for default lib dir
info install using lib dir: /usr/local/lib
/home/pi/opencv-virtualuvc/node_modules/opencv4nodejs/install/install.js:45
  throw new Error('no OpenCV libraries found in lib dir: ' + libDir)
  ^

Error: no OpenCV libraries found in lib dir: /usr/local/lib
    at Object.<anonymous> (/home/pi/opencv-virtualuvc/node_modules/opencv4nodejs/install/install.js:45:9)
    at Module._compile (internal/modules/cjs/loader.js:778:30)
    at Object.Module._extensions..js (internal/modules/cjs/loader.js:789:10)
    at Module.load (internal/modules/cjs/loader.js:653:32)
    at tryModuleLoad (internal/modules/cjs/loader.js:593:12)
    at Function.Module._load (internal/modules/cjs/loader.js:585:3)
    at Function.Module.runMain (internal/modules/cjs/loader.js:831:12)
    at startup (internal/bootstrap/node.js:283:19)
    at bootstrapNodeJSCore (internal/bootstrap/node.js:623:3)
```

### エラーを解決するためにopencv4nodejsリポジトリにissueを立ててみた

[Can't install opencv4nodejs · Issue #733 · justadudewhohacks/opencv4nodejs · GitHub](https://github.com/justadudewhohacks/opencv4nodejs/issues/733)
